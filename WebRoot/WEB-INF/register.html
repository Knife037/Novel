<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<link href="dist/css/bootstrap.min.css" rel="stylesheet">
<style>
	.body{
		margin-top:1%;
		margin-left:40%;
		margin-right:40%;
	}
</style>
</head>
<body>
<div class="body">
	<form id="form" method="get">
		<label>用户名</label>
		<div id="block-username" class="form-group">
			<input id="txtUsername" name="username" type="text" class="form-control" placeholder="请输入用户名"/>
			<span id="icon-username" class="" aria-hidden="true"></span>
			<span id="tip-username" class="sr-only">该用户名已被注册</span>
		</div>
		<label>昵称</label>
		<div id="block-nickname" class="form-group">			
			<input id="txtNickname" name="nickname" type="text" class="form-control" placeholder="请输入昵称"/>
			<span id="icon-nickname" class="" aria-hidden="true"></span>
			<span id="tip-nickname" class="sr-only"></span>
		</div>
		<label>邮箱</label>
		<div id="block-email" class="form-group">			
			<input id="txtEmail" name="email" type="text" class="form-control" placeholder="请输入用户名"/>
			<span id="icon-email" class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
			<span id="tip-email" class="sr-only">邮箱格式错误</span>
		</div>
		<label>密码</label>
		<div class="form-group">
			<input id="txtPassword" name="password" type="password" class="form-control" placeholder="请输入密码" value=""/>
		</div>
		<label>请重复密码</label>
		<div id="block-password" class="form-group">
			<input id="txtRepeatPassword" name="repeatPassword" type="password" class="form-control" placeholder="请重复密码"  value=""/>
			<span id="icon-password" class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>
			<span id="tip-password" class="sr-only">两次密码不一致</span>
		</div>
		<div class="form-group">
			<button id="btn-register" type="button" class="btn btn-primary form-control">注册</button>
		</div>
	</form>
</div>
<div class="body">
	
</div>
</body>
<script src="dist/js/jquery.min.js"></script>
<script src="dist/js/bootstrap.min.js"></script>
<script>
	$(document).ready(function () {
		var isUsernameOk = false;
		var isEmailOk = false;
		var isPasswordOk = false;
		var isNicknameOk = false;
		$("#btn-register").click(function() {
			if(isUsernameOk && isEmailOk && isPasswordOk && isNicknameOk) {
				$("#form").submit();
			}
		});
		$("#txtUsername").blur(function() {
			var txtUsername = $(this);
			if(txtUsername.val() == "") {
				$("#block-username").attr("class", "form-group has-error has-feedback");
				$("#icon-username").attr("class", "glyphicon glyphicon-remove form-control-feedback");
				$("#tip-username").attr("class", "");
				$("#tip-username").text("用户名不能为空");
				isUsernameOk = false;
			} else {
				$.get("isUserExist?username=" + txtUsername.val(), function(data) {
					if(data == "false") {
						$("#block-username").attr("class", "form-group has-error has-feedback");
						$("#icon-username").attr("class", "glyphicon glyphicon-remove form-control-feedback");
						$("#tip-username").attr("class", "");
						$("#tip-username").text("该用户名已被注册");
						isUsernameOk = false;
					} else {
						$("#block-username").attr("class", "form-group has-success has-feedback");
						$("#icon-username").attr("class", "glyphicon glyphicon-ok form-control-feedback");
						$("#tip-username").attr("class", "sr-only");
						isUsernameOk = true;
					}
				});
			}
		});
		$("#txtRepeatPassword").blur(function() {
			var password = $("#txtPassword");
			var repeatPassword = $("#txtRepeatPassword");
			if(password.val() == "" || repeatPassword.val() == "") {
				$("#block-password").attr("class", "form-group has-error has-feedback");
				$("#icon-password").attr("class", "glyphicon glyphicon-remove form-control-feedback");
				$("#tip-password").attr("class", "");
				$("#tip-password").text("密码不能为空");
				isPasswordOk = false;
			} else if(password.val() != repeatPassword.val()) {
				password.val("");
				repeatPassword.val("");
				$("#block-password").attr("class", "form-group has-error has-feedback");
				$("#icon-password").attr("class", "glyphicon glyphicon-remove form-control-feedback");
				$("#tip-password").attr("class", "");
				$("#tip-password").text("两次密码不一致");
				isPasswordOk = false;
			} else {
				$("#block-password").attr("class", "form-group has-success has-feedback");
				$("#icon-password").attr("class", "glyphicon glyphicon-ok form-control-feedback");
				$("#tip-password").attr("class", "sr-only");
				isPasswordOk = true;
			}
	
		});
		$("#txtEmail").blur(function() {
			var email = $(this);
			if(email.val() == "") {
				$("#block-email").attr("class", "form-group has-error has-feedback");
				$("#icon-email").attr("class", "glyphicon glyphicon-remove form-control-feedback");
				$("#tip-email").attr("class", "");
				$("#tip-email").text("邮箱不能为空");
				isEmailOk = false;
			} else if (!(email.val().search(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/) != -1)) {
				$("#block-email").attr("class", "form-group has-error has-feedback");
				$("#icon-email").attr("class", "glyphicon glyphicon-remove form-control-feedback");
				$("#tip-email").attr("class", "");
				$("#tip-email").text("邮箱格式错误");
				isEmailOk = false;
			} else {
				$("#block-email").attr("class", "form-group has-success	 has-feedback");
				$("#icon-email").attr("class", "glyphicon glyphicon-ok form-control-feedback");
				$("#tip-email").attr("class", "sr-only");
				isEmailOk = true;
			}
		});
		$("#txtNickname").blur(function() {
			var email = $(this);
			if(email.val() == "") {
				$("#block-nickname").attr("class", "form-group has-error has-feedback");
				$("#icon-nickname").attr("class", "glyphicon glyphicon-remove form-control-feedback");
				$("#tip-nickname").attr("class", "");
				$("#tip-nickname").text("昵称不能为空");
				isNicknameOk = false;
			} else {
				$("#block-nickname").attr("class", "form-group has-success	 has-feedback");
				$("#icon-nickname").attr("class", "glyphicon glyphicon-ok form-control-feedback");
				$("#tip-nickname").attr("class", "sr-only");
				isNicknameOk = true;
			}
		});
	});
</script>
</html>